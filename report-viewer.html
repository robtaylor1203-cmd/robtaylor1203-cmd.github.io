<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Report Viewer - TeaTrade</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body class="market-reports-page">
    <header class="site-header">
        <div class="header-top-bar">
            <a href="corporate.html" class="header-logo"><h1>Tea<span>Trade</span></h1></a>
            <div class="header-search-wrapper"><input type="text" class="header-search-bar" placeholder="Global site search..."></div>
            <div class="user-actions">
                </div>
            <button class="mobile-menu-toggle" aria-label="Toggle navigation" aria-expanded="false">
                </button>
        </div>
        <nav class="secondary-nav">
            <ul>
                <li><a href="data.html">Data</a></li>
                <li><a href="market-reports.html" class="active">Market Reports</a></li>
                <li><a href="#">Auctions</a></li>
                <li><a href="visuals.html">Visuals</a></li>
            </ul>
        </nav>
    </header>

    <main class="page-container">
        <div class="dashboard-header">
            <h2 class="page-title" id="report-title">Loading Report...</h2>
        </div>
        <p id="report-meta" style="margin-bottom: 24px; color: #5f6368;"></p>

        <div id="report-content" style="display: none; font-family: monospace; white-space: pre-wrap; background-color: #f1f3f4; padding: 15px; border-radius: 8px; border: 1px solid #ccc; word-wrap: break-word;">
            </div>
        <div id="loading-indicator">Loading data...</div>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const loadingIndicator = document.getElementById('loading-indicator');
            const reportTitleEl = document.getElementById('report-title');
            const reportMetaEl = document.getElementById('report-meta');
            const reportContentEl = document.getElementById('report-content');
            
            try {
                const params = new URLSearchParams(window.location.search);
                const reportTitleToFind = params.get('title');
                if (!reportTitleToFind) throw new Error("No report title specified in URL.");

                const response = await fetch('market-reports-library.json');
                if (!response.ok) throw new Error(`Could not load library. Status: ${response.status}`);
                const library = await response.json();

                let foundReport = null;
                for (const location in library) {
                    if (library[location][reportTitleToFind]) {
                        foundReport = library[location][reportTitleToFind];
                        break;
                    }
                }
                if (!foundReport) throw new Error(`Could not find report "${reportTitleToFind}" in the library.`);
                
                // --- THIS IS THE STABLE PART ---
                // We will simply display the title, description, and the raw data.
                // This proves that the data is being loaded correctly for every report.
                
                reportTitleEl.textContent = foundReport.title;
                reportMetaEl.textContent = foundReport.description;

                // Display the found data as a clean JSON string
                reportContentEl.innerHTML = `<h3>Report Data Loaded Successfully:</h3><pre>${JSON.stringify(foundReport, null, 2)}</pre>`;
                
                reportContentEl.style.display = 'block';
                loadingIndicator.style.display = 'none';

            } catch (error) {
                console.error('Error loading report:', error);
                reportTitleEl.textContent = 'Error loading report.';
                loadingIndicator.textContent = `Error: ${error.message}`;
            }
        });
    </script>
</body>
</html>
